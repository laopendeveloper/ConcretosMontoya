{% extends "base.html" %}

{% load static %}

{% block head_content %}
    <title>Detalles | Concretos Montoya</title>
{% endblock%}

{% block styles %}
<link rel="stylesheet" type="text/css" href="{% static 'schedule/core/main.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'schedule/daygrid/main.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'schedule/timegrid/main.css' %}">
<link rel="stylesheet" type="text/css" href="{% static 'schedule/list/main.css' %}">
{% endblock %}

{% block container %}

    <div class="container">
      <div class="row">
        <div class="col-md-5" style="margin-top: 20px;">
              <div class="card">
                  <div class="card-body">
                  	<div class="row">
                  		<div class="col-md-4">
                  			{% if machine.photo %}
                  				<img src="{{ machine.photo.url }}" class="rounded-circle" style="width: 180px; height: 180px;" />
                  			{% else %}
                  				<img src="{% static 'img/default_machine.jpg' %}" class="rounded-circle" />
                  			{% endif %}
                  		</div>
                  		<div class="col-md-8">
                  			<h5 class="card-title">{{ machine.name }}</h5>
		                    <p class="card-text" style="height: 60px;">
		                    	{{ machine.description }}
		                    </p>
                  		</div>
                  	</div>
                    
                  </div>
                  <ul class="list-group list-group-flush">
                    <li class="list-group-item">
                      <strong>NÃºmero de serie:</strong> {{ machine.serial_number }}
                    </li>
                    <li class="list-group-item">
                      <strong>Modelo:</strong> {{ machine.model }}
                    </li>
                    <li class="list-group-item">
                      <strong>Price de compra:</strong> {{ machine.price }}
                    </li>
                    <li class="list-group-item">
                      <strong>Tipo:</strong> {{ machine.machine_type }}
                    </li>
                    {% if machine.is_available %}
                      <li class="list-group-item">
                        <strong>Estatus:</strong> 
                        <span class="bg-success" style="border:none; color: white; padding: 2px; border-radius: 5px; "><b>Disponible</b></span>
                      </li>
                    {% else %}
                      <li class="list-group-item">
                        <strong>Estatus:</strong> 
                        <span class="bg-warning" style="border:none; color: white; padding: 2px; border-radius: 5px; "><b>En renta</b></span>
                      </li>
                    {% endif %}
                    <li class="list-group-item">
                      <strong>Precio de renta:</strong> {{ machine.rent_price }}
                    </li>
                  </ul>
              </div>
            </div>

            <div class="col-md-5" style="margin-top: 20px;">
              <div id="calendar" style="background-color: white;"></div>
            </div>

            <div class="col-md-2" style="margin-top: 20px;">
              <div class="btn-group-vertical">
                <a href="{% url 'machines:feed' %}" class="btn btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="Regresar">
                  <i class="fa fa-undo fa-2x"></i>
                </a>
                <a href="{% url 'machines:update' machine.pk %}" class="btn btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="Editar">
                  <i class="fa fa-edit fa-2x"></i>
                </a>
                <a href="{% url 'machines:rent' machine.pk %}" class="btn btn-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="Rentar">
                  <i class="fa fa-shopping-cart fa-2x"></i>
                </a>
              </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block scripts %}
<script type="text/javascript" src="{% static 'schedule/core/main.js' %}"></script>
<script type="text/javascript" src="{% static 'schedule/interaction/main.js' %}"></script>
<script type="text/javascript" src="{% static 'schedule/daygrid/main.js' %}"></script>
<script type="text/javascript" src="{% static 'schedule/timegrid/main.js' %}"></script>
<script type="text/javascript" src="{% static 'schedule/list/main.js' %}"></script>

<script type="text/javascript">
  var calendarEl = document.getElementById('calendar');

  var calendar = new FullCalendar.Calendar(calendarEl, {
    locale: 'es',
    plugins: [ 'interaction', 'dayGrid', 'timeGrid', 'list' ],
    height: 'parent',
    header: {
      left: 'prev,next today',
      center: 'title',
      // right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
      right: false 
    },
    defaultView: 'dayGridMonth',
    //defaultDate: '{% now "Y-m-d" %}',
    navLinks: true, // can click day/week names to navigate views
    editable: false,
    eventLimit: true, // allow "more" link when too many events
    events: [
      {% for r in rent %}
        {
          title: '{{ r.client }}',
          start: '{{ r.rent_from|date:"Y-m-d H:m" }}',
          end: '{{ r.rent_to|date:"Y-m-d H:m" }}',
          color: '#33C3FF'
        },
      {% endfor %}
    ]

  });

  calendar.render();
</script>
{% endblock %}